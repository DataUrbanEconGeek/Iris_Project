---
title: 'Predicting Iris Species: Clustering'
author: "Andrew Rosa"
date: "5/13/2017"
output: 
        html_document:
                includes:
                        in_header: head.html
                css: style.css
---

### Background

Edgar Anderson was an American botanist. In 1929 he had moved to Britain where he studied and worked at the John Innes Horticultural Institute. It was while studying here that he create a data set containing the sepal lengths, widths, and petal lengths and widths of three different Iris flower species. His coworker and statistician R.A. Fisher then used that data set as an example for statistical methods on classification. This project seeks to demonstrate predicting the classification of an Iris flower's species with the use of clustering algorithms. 

### First

We would normally load in the data, but because this data-set is widely used the CRAN community has already provided the data-set in R's base data-sets package. We can immediately start to use it.

```{r}
iris_df <- iris

str(iris)
```

We can see here that this data-set contains 150 observations. We also see that four of our variables are quantitative and one variable(species) is categorical. Some manipulation will have to be done to the data set before we begin. We're going to remove the species variable for now and save it in a different list for later. 

```{r}
species <- as.list(iris_df$Species)
species <- unlist(species)
iris_df <- iris_df[1:4]
```

### Exploritory Visualizations

We're now ready to look at the data. 

```{r warning=FALSE}
library(ggplot2)
library(gridExtra)
plot_1 <- ggplot(iris_df, aes(x = Petal.Length, y = Petal.Width)) +
                geom_point()
plot_2 <- ggplot(iris_df, aes(x = Sepal.Length, y = Sepal.Width)) +
                geom_point()
plot_3 <- ggplot(iris_df, aes(x = Petal.Length, y = Petal.Width)) +
                stat_density_2d()
plot_4 <- ggplot(iris_df, aes(x = Sepal.Length, y = Sepal.Width)) +
                stat_density_2d()

grid.arrange(plot_1, plot_2, plot_3, plot_4, ncol = 2, nrow = 2)
```

### Hierarchical Clustering

```{r}
iris_dist <- dist(iris_df, method = "euclidean")

model_1 <- hclust(iris_dist, method = "single")

model_1_cut <- cutree(model_1, 3)

table(species, model_1_cut)
```

```{r echo=FALSE}
plot_5 <- ggplot(iris_df, aes(x = Petal.Length, y = Petal.Width)) +
                geom_point(aes(col = factor(model_1_cut))) +
                theme(legend.position = "none") +
                theme(axis.title.x = element_blank())
plot_6 <- ggplot(iris_df, aes(x = Sepal.Length, y = Sepal.Width)) +
                geom_point(aes(col = factor(model_1_cut))) +
                scale_color_discrete(name = "Clusters     ") +
                theme(axis.title.x = element_blank())
plot_7 <- ggplot(iris_df, aes(x = Petal.Length, y = Petal.Width)) +
                geom_point(aes(col = species)) +
                theme(legend.position = "none")
plot_8 <- ggplot(iris_df, aes(x = Sepal.Length, y = Sepal.Width)) +
                geom_point(aes(col = species))

grid.arrange(plot_5, plot_6, plot_7,  plot_8, ncol = 2, nrow = 2,
             widths = c(2.3, 3.2), heights = c(2.6, 2.8))
```

```{r}
iris_dist <- dist(iris_df, method = "euclidean")

model_2 <- hclust(iris_dist, method = "complete")

model_2_cut <- cutree(model_2, 3)

table(species, model_2_cut)
```

```{r echo=FALSE}
plot_9 <- ggplot(iris_df, aes(x = Petal.Length, y = Petal.Width)) +
                geom_point(aes(col = factor(model_2_cut))) +
                theme(legend.position = "none") +
                theme(axis.title.x = element_blank()) +
                scale_color_manual(values=c("#F8766D", "#619CFF", "#00BA38"))
plot_10 <- ggplot(iris_df, aes(x = Sepal.Length, y = Sepal.Width)) +
                geom_point(aes(col = factor(model_2_cut))) +
                scale_color_manual(name = "Clusters     ", values=c("#F8766D", "#619CFF", "#00BA38")) +
                theme(axis.title.x = element_blank())
plot_11 <- ggplot(iris_df, aes(x = Petal.Length, y = Petal.Width)) +
                geom_point(aes(col = species)) +
                theme(legend.position = "none")
plot_12 <- ggplot(iris_df, aes(x = Sepal.Length, y = Sepal.Width)) +
                geom_point(aes(col = species))

grid.arrange(plot_9, plot_10, plot_11,  plot_12, ncol = 2, nrow = 2,
             widths = c(2.3, 3.2), heights = c(2.6, 2.8))
```

### K-Means Clustering

```{r}
set.seed(3949)
model_3 <- kmeans(iris_df, centers = 3)
```


```{r}
plot_13 <- ggplot(iris_df, aes(x = Petal.Length, y = Petal.Width)) +
                geom_point(aes(col = factor(model_3_cut))) +
                theme(legend.position = "none") +
                theme(axis.title.x = element_blank())
plot_14 <- ggplot(iris_df, aes(x = Sepal.Length, y = Sepal.Width)) +
                geom_point(aes(col = factor(model_3_cut))) +
                scale_color_discrete(name = "Clusters     ") +
                theme(axis.title.x = element_blank())
plot_15 <- ggplot(iris_df, aes(x = Petal.Length, y = Petal.Width)) +
                geom_point(aes(col = species)) +
                theme(legend.position = "none")
plot_16 <- ggplot(iris_df, aes(x = Sepal.Length, y = Sepal.Width)) +
                geom_point(aes(col = species))

grid.arrange(plot_9, plot_10, plot_11,  plot_12, ncol = 2, nrow = 2,
             widths = c(2.3, 3.2), heights = c(2.6, 2.8))
```



```{r}
table(species, model_3$cluster)
```



```{r}
iris_sc <- as.data.frame(scale(iris_df))
model_4 <- kmeans(iris_sc, 3)

table(species, model_4$cluster)
```




